!function(){"use strict";function e(e){return"function"==typeof e?e():e}function t(e){return n(e)||i(e)||o(e)||function(e){return e.hasOwnProperty("html")||e.hasOwnProperty("element")}(e)}function n(e){return e.hasOwnProperty("action")}function i(e){return e.hasOwnProperty("href")}function o(e){return e.hasOwnProperty("subMenu")}function r(e,t){var n;e.addEventListener("mouseenter",(function(e){n=setTimeout((function(){return t(e)}),150)})),e.addEventListener("mouseleave",(function(){return clearTimeout(n)}))}function a(t){return e(t.disabled)||o(t)&&"function"!=typeof t.subMenu&&0===t.subMenu.length}function d(r){var d,c=document.createElement("li");if(function(e){return e.hasOwnProperty("isDivider")}(r))return c.className="divider",c;if(Object.entries(null!==(d=e(r.attributes))&&void 0!==d?d:{}).forEach((function(e){var t=e[0],n=e[1];return c.setAttribute(t,n)})),function(t,n){var i=e(t.html),o="<span>".concat(e(t.text),"</span>"),r=e(t.element);r?n.append(r):n.innerHTML=i||o,n.title=e(t.tooltip)||"",t.style&&n.setAttribute("style",e(t.style));t.icon&&(n.classList.add("icon"),n.innerHTML+='<img class="icon" src="'.concat(e(t.icon),'" />'));for(var a=0,d=Object.entries(e(t.events)||{});a<d.length;a++){var c=d[a],s=c[0],u=c[1],l="function"==typeof u?{listener:u,options:{}}:u,h=l.listener,f=l.options;n.addEventListener(s,h,f)}}(r,c),!t(r))return c.classList.add("heading"),c;if(a(r))return c.classList.add("disabled"),o(r)&&c.classList.add("submenu"),c;if(c.classList.add("interactive"),i(r)){var s=document.createElement("a");return s.append.apply(s,Array.from(c.childNodes)),s.href=e(r.href),r.hasOwnProperty("download")&&(s.download=e(r.download)),r.hasOwnProperty("target")&&(s.target=e(r.target)),c.append(s),c}return n(r)?(c.addEventListener("click",r.action),c):(c.classList.add("submenu"),c)}var c="r",s="d";function u(e,t){var n=f(),i=window.visualViewport,o=i.width,r=i.height;Object.assign(e.style,{maxHeight:r/n.y+"px",maxWidth:o/n.x+"px"});var a=function(e){var t=e.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var n=h(t);return document.body.removeChild(t),n}(e);a.width=Math.trunc(a.width)+1,a.height=Math.trunc(a.height)+1;var d={x:0,y:0};if(t instanceof Element){var u=h(t),p=u.x,m=u.width,v=u.y;d={x:"r"===c?p+m:p-a.width,y:v},t.className.includes("submenu")&&(d.y+="d"===s?4:-12);var y=l(a,d);d.x!==y.x&&(c="r"===c?"l":"r",d.x="r"===c?p+m:p-a.width),d.y!==y.y&&(s="u"===s?"d":"u",d.y=y.y),d=l(a,d)}else{var g=""!==document.body.style.transform?document.body.getBoundingClientRect():{x:0,y:0};d=l(a,{x:(t.clientX-g.x)/n.x,y:(t.clientY-g.y)/n.y})}Object.assign(e.style,{left:d.x+"px",top:d.y+"px",width:a.width+"px",height:a.height+"px"})}function l(e,t){var n=window.visualViewport,i=n.width,o=n.height,r=""!==document.body.style.transform?document.body.getBoundingClientRect():{left:0,top:0},a=r.left,d=r.top,u=f(),l=-a/u.x,h=-d/u.y,p=(i-a)/u.x,m=(o-d)/u.y;return{x:"r"===c?t.x+e.width>p?p-e.width:t.x:t.x<l?l:t.x,y:"d"===s?t.y+e.height>m?m-e.height:t.y:t.y<h?h:t.y+e.height>m?m-e.height:t.y}}function h(e){var t=e.offsetLeft,n=e.offsetTop,i=e.offsetHeight,o=e.offsetWidth;if(e.offsetParent instanceof HTMLElement){var r=h(e.offsetParent);return{x:t+r.x,y:n+r.y,width:o,height:i}}return{x:t,y:n,width:o,height:i}}function f(){var e=document.body,t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth,y:t.height/e.offsetHeight}}var p=function(){function n(){var e=this;this.cache={},this.preventCloseOnScroll=!1,window.addEventListener("click",(function(t){var n=t.target instanceof Element&&t.target.parentElement;n&&"interactive"===n.className||e.hide()})),window.addEventListener("resize",(function(){e.hide()}));var t=0;window.addEventListener("wheel",(function(){clearTimeout(t),t=setTimeout((function(){e.preventCloseOnScroll?e.preventCloseOnScroll=!1:e.hide()}))}),{passive:!0}),window.addEventListener("keydown",(function(t){"Escape"===t.key&&e.hide()})),n.addStylesToDom()}return n.getInstance=function(){n.instance||(n.instance=new n);var e=n.instance;return{attach:e.attach.bind(e),delete:e.delete.bind(e),hide:e.hide.bind(e),show:e.show.bind(e),update:e.update.bind(e)}},n.prototype.attach=function(e,t,n){var i=this;if(void 0===n&&(n={}),"function"==typeof n)return this.attach(e,t,{onBeforeShow:n});var o=this.getConfig(n),r=document.querySelector(e);if(void 0===this.cache[e])if(r){var a=function(e){i.show(t,e,o)};this.cache[e]={ctxMenu:t,handler:a,config:o},r.addEventListener("contextmenu",a)}else console.error("target element ".concat(e," not found"));else console.error("target element ".concat(e," already has a context menu assigned. Use ContextMenu.update() intstead."))},n.prototype.update=function(e,t,n){if(void 0===n&&(n={}),"function"==typeof n)return this.update(e,t,{onBeforeShow:n});var i=this.cache[e],o=Object.assign({},null==i?void 0:i.config,n),r=document.querySelector(e);i&&(null==r||r.removeEventListener("contextmenu",i.handler)),delete this.cache[e],this.attach(e,t||(null==i?void 0:i.ctxMenu)||[],o)},n.prototype.delete=function(e){var t=this.cache[e];if(t){var n=document.querySelector(e);n?(n.removeEventListener("contextmenu",t.handler),delete this.cache[e]):console.error("target element ".concat(e," does not exist (anymore)"))}else console.error("no context menu for target element ".concat(e," found"))},n.prototype.show=function(e,t,n){var i,o,r,a=this;t instanceof MouseEvent&&(t.stopImmediatePropagation(),t.preventDefault()),this.hide();var d=this.getConfig(n);this.onHide=d.onHide,this.onBeforeHide=d.onBeforeHide;var c=null!==(o=null===(i=d.onBeforeShow)||void 0===i?void 0:i.call(d,e.slice(),t instanceof MouseEvent?t:void 0))&&void 0!==o?o:e;this.menu=this.generateDOM(c,t,d.attributes),document.body.appendChild(this.menu),null===(r=d.onShow)||void 0===r||r.call(d,this.menu),this.menu.addEventListener("wheel",(function(){a.preventCloseOnScroll=!0}),{passive:!0})},n.prototype.hide=function(e){var t,n,i;void 0===e&&(e=this.menu),null===(t=this.onBeforeHide)||void 0===t||t.call(this,e),c="r",s="d",e&&(e===this.menu&&delete this.menu,null===(n=e.parentElement)||void 0===n||n.removeChild(e)),null===(i=this.onHide)||void 0===i||i.call(this,e),this.onBeforeHide=void 0,this.onHide=void 0},n.prototype.getConfig=function(e){return void 0===e&&(e={}),Object.assign({onBeforeShow:function(e){return e},onBeforeHide:function(){},onShow:function(){},onHide:function(){}},e)},n.prototype.generateDOM=function(n,i,c){var s=this;void 0===c&&(c={});var l=document.createElement("ul");return 0===n.length&&(l.style.display="none"),n.forEach((function(n){var i=d(n);r(i,(function(){var e,t=null===(e=i.parentElement)||void 0===e?void 0:e.querySelector("ul");t&&t.parentElement!==i&&s.hide(t)})),t(n)&&!a(n)&&(o(n)?r(i,(function(t){i.querySelector("ul")||s.openSubMenu(t,e(n.subMenu),i,e(n.subMenuAttributes))})):i.addEventListener("click",(function(){s.hide()}))),l.appendChild(i)})),Object.entries(c).forEach((function(e){var t=e[0],n=e[1];return l.setAttribute(t,n)})),l.classList.add("ctxmenu"),u(l,i),l.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),l.addEventListener("click",(function(e){var t=e.target instanceof Element&&e.target.parentElement;t&&"interactive"!==t.className&&e.stopPropagation()})),l},n.prototype.openSubMenu=function(e,t,n,i){var o;void 0===i&&(i={});var r=null===(o=n.parentElement)||void 0===o?void 0:o.querySelector("li > ul");r&&r.parentElement!==n&&this.hide(r),n.appendChild(this.generateDOM(t,n,i))},n.addStylesToDom=function(){var e=function(){if("loading"===document.readyState)return document.addEventListener("readystatechange",(function(){e()}));var t=document.createElement("style");t.innerHTML='html{min-height:100%}.ctxmenu{position:fixed;border:1px solid #999;padding:2px 0;box-shadow:#aaa 3px 3px 3px;background:#fff;margin:0;z-index:9999;overflow-y:auto;font:15px Verdana, sans-serif;box-sizing:border-box}.ctxmenu li{margin:1px 0;display:block;position:relative;user-select:none}.ctxmenu li.heading{font-weight:bold;margin-left:-5px}.ctxmenu li span{display:block;padding:2px 20px;cursor:default}.ctxmenu li a{color:inherit;text-decoration:none}.ctxmenu li.icon{padding-left:15px}.ctxmenu img.icon{position:absolute;width:18px;left:10px;top:2px}.ctxmenu li.disabled{color:#ccc}.ctxmenu li.divider{border-bottom:1px solid #aaa;margin:5px 0}.ctxmenu li.interactive:hover{background:rgba(0, 0, 0, .1)}.ctxmenu li.submenu::after{content:"";position:absolute;display:block;top:0;bottom:0;right:.4em;margin:auto .1rem auto auto;border-right:1px solid #000;border-top:1px solid #000;transform:rotate(45deg);width:.3rem;height:.3rem}.ctxmenu li.submenu.disabled::after{border-color:#ccc}',document.head.insertBefore(t,document.head.childNodes[0]),e=function(){}};e()},n}().getInstance();
/*! ctxMenu v1.7.0 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/window.ctxmenu=p}();
